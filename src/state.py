import queue

from src.ahk import Ahk
from src.parser import Parser


class State:
    current_filename = None  # Current filename for output scraped characters
    command_queue = None  # Next command for scraping a bundle
    last_command = None  # the Last typed command from User
    bundles_checked = None  # set of bundles we've checked
    series_checked = None  # set of series we've checked

    def __init__(self):
        self.command_queue = queue.Queue()
        # for item in ['$imab A-1 Pictures', '$imab Adult Swim', '$imab Aniplex', '$imab ASCII Media Works', '$imab Bandai Namco', '$imab Capcom', '$imab Ecchi', '$imab Harem', '$imab Jump Magazines', '$imab Kadokawa Future Publishing', '$imab Kadokawa Shoten', '$imab Mahou Shoujo', '$imab Mecha', '$imab Monster Girls', '$imab Netflix Originals', '$imab Platformer Games', '$imab Shueisha', '$imab Side-scrolling Games', '$imab Sunrise', '$imab Toonami', '$imab Trigger', '$imab Wayforward', '$imab Webcomics', '$imab Young Ace']:
        #     self.command_queue.put(item)
        # self.bundles_checked = set()
        # self.bundles_checked = {'A-1 Pictures', 'Adult Swim', 'Aniplex', 'ASCII Media Works', 'Bandai Namco', 'Capcom', 'Ecchi', 'Harem', 'Jump Magazines', 'Kadokawa Future Publishing', 'Kadokawa Shoten', 'Mahou Shoujo', 'Mecha', 'Monster Girls', 'Netflix Originals', 'Platformer Games', 'Shueisha', 'Side-scrolling Games', 'Sunrise', 'Toonami', 'Trigger', 'Wayforward', 'Webcomics', 'Young Ace'}
        self.bundles_checked = {"4-koma", "A-1 Pictures", "Adult Swim", "Aniplex", "ASCII Media Works", "Atlus", "Bandai Namco", "Bessatsu Margaret", "Capcom", "Dengeki Bunko", "Dengeki Daioh", "Ecchi", "Fate", "Gangan Comics", "Gangan Joker", "Gangan Online", "GFantasy", "Gosho Works", "GYAO!", "Hakusensha", "Harem", "Hiromu Arakawa", "Houbunsha", "Idols", "Incest & NBR", "Isekai", "Jump Magazines", "Jump Square", "Kadokawa Future Publishing", "Kadokawa Shoten", "Killing Games", "Kodansha", "Kyoto Animation", "Mahou Shoujo", "Manga Time Kirara", "Mecha", "Media Factory", "Monster Girls", "Netflix Originals", "Nitroplus", "Platformer Games", "Satelight", "Science Adventure", "SEGA", "Shogakukan", "Shueisha", "Side-scrolling Games", "Sports Animanga", "Square Enix", "Studio Deen", "Sunrise", "Taito", "TMS Entertainment", "Toonami", "Trigger", "TYPE-MOON", "Virtual Music", "Virtual YouTubers", "Wayforward", "Webcomics", "Weekly Shounen Magazine", "Weekly Shounen Sunday", "Weekly Young Jump", "Young Ace", "YouTube"}
        self.series_checked = set()
        for item in ["Code: Realize Series", "Comedy Central", "Comic High!", "Comic Strips", "Comic Zenon", "Comic ZERO-SUM", "Comico", "Comics", "ComicWalker", "Compile Heart", "Conception Series", "Confession Executive Committee ~Love Series~", "Cooking Series", "Cool-kyou Shinja's Works", "Corpse Party Series", "Criminal Girls Series", "Croteam", "Crunchyroll Originals", "Cyberpunk Bartender Action", "Cygames", "Cytus Series", "D&D Genre", "Da Capo Series", "Daitosha", "Dan Schneider's Works", "Danganronpa", "Danganronpa Another Series", "Danganronpa Fangames", "Darius Series", "Dark Cloud Series", "Dark Horse Comics", "Dark Marchen", "Date A Live Series", "Dating Sims", "David Production", "DC Multiverse", "Dead Games", "Dead Rising Series", "Demonbane Series", "Dengeki Bunko", "Dengeki Daioh", "Dept. Heaven", "Destiny", "Deus Ex Series", "Devil Children", "Devil May Cry Series", "Devil Summoner", "Devil Survivor Series", "Devilman Series", "Devolver Digital", "Diablo Series", "Dies irae Series", "Digimon", "Digimon Games", "Digimon Story Series", "Digimon World Series", "Digital Devil Story", "Dimension 20", "Disgaea Series", "Disturbing Imagery", "DMM Games", "Doga Kobo", "Donkey Kong Series", "DONTNOD Entertainment", "Double Fine", "Dr. Seuss", "Dragon Age Series", "Dragon Ball Anime", "Dragon Ball Games", "Dragon Ball Series", "Dragon Quest", "Drakengard Series", "DreamWorks Animation", "DreamWorks Pictures", "Dress-Up Games", "Dynamite Entertainment", "E ve", "EA Sports", "Earth Star Entertainment", "EasyGameStation", "Ecchi", "Education", "Eight Bit", "Electronic Arts", "Elibe Series", "Ensemble Studios", "Entabridge", "Enterbrain", "Epic Games", "Eroge", "Etrian Odyssey Series", "Eureka Seven Series", "Eushully", "Evangelion", "EXA_PICO", "F-Zero Series", "Fable Series", "Fabula Nova Crystallis: Final Fantasy", "Fallout Series", "Fanime", "Fanworks", "Far Cry Series", "Fashion Doll", "Fatal Frame Series", "Fate", "Fate/EX Series", "Feel. Inc.", "Fighting Games", "FilmCow", "Final Fantasy", "Final Fantasy X Series", "Fire Emblem", "FLCL Series", "FNaF Series", "Fortissimo Series", "Frederator Studios", "Freebird Games", "FromSoftware", "Frontier Works", "Frontwing", "Fruitbat Factory", "Fujimi Shobo", "Furry", "Futabasha", "Future Card Buddyfight Series", "Gacha Games", "Gainax", "Game Grumps", "Gangan Comics", "Gangan Joker", "Gangan Online", "Gangan Powered", "Gangan Wing", "Garo Series", "Gatobob's Works", "Gears of War Series", "Geki!Chumai", "Genkai Tokki", "Gessan", "Get Married! Series", "GFantasy", "GHOST's Works", "Giant Robo Series", "Giga", "Gijinka", "Girls' Love", "Go Nagai", "Golden Sun Series", "Gonzo", "Gosho Works", "Grand Theft Auto", "Grandia Series", "Grasshopper Manufacture", "Gravity Rush Series", "Grisaia", "Gundam", "GYAO!", "Hajime Kanzaka's Works", "Hakusensha", "Hal Film Maker", "Halo Series", "Hana to Yume", "Hanamura Mai's Art", "Hanna-Barbera", "Happy Elements", "Harem", "Haruhara Works", "Haruhi Suzumiya Series", "Harumaki Gohan", "Harvest Moon Series", "Hasbro", "Hataraku Saibou Series", "Hatoful Boyfriend Series", "Hazbin Hotel Series", "Hentai", "Hero Series", "Hibiki Works", "Hidan no Aria Series", "Hiiro no Kakera Series", "Hirohiko Araki's Works", "Hiromu Arakawa", "HitenKei's Works", "Hiveworks Comics", "Hollow Knight Series", "Honoo no Haramase Franchise", "Hoods Entertainment", "Horror Genre", "Hotline Miami Series", "Houbunsha", "HSverse", "Humongous Entertainment", "HuniePot", "Hyperdimension Neptunia Series", "iD Software", "Idea Factory", "Idols", "IDW Publishing", "Ikusa Megami Series", "Ikémen Series", "Image & Form", "Image Comics", "Imitation Crystal", "Inazuma Eleven Series", "Incest & NBR", "Indie Games", "inFAMOUS Series", "Infinity Series", "Inio Asano", "Innocent Grey", "Insomniac Games", "Intelligent Systems", "Inti Creates", "InuYasha Series", "Isekai", "Isekai Quartet", "Isuna Hasekura's Works", "Ivalice Alliance", "J.C.Staff", "Jerma985", "Jet Set Radio Series", "Jewelpet Series", "Jhonen Vasquez's Works", "JoJo's Bizarre Adventure", "Jugdral Series", "Jump Magazines", "Jump Square", "Junji Ito's Works", "Jurassic Park Series", "K-Pop", "Kadokawa Future Publishing", "Kadokawa Shoten", "Kagura Games", "Kamen Rider Series", "Kara no Shoujo Series", "Katamari Series", "Kazuaki's Art", "Kazuki Yone's Art", "Kazuma Kamachi's Works", "Kemono Friends Series", "Ken ga Kimi franchise", "Kenganverse", "Key", "Kill The Past", "Killing Games", "Killmonday Games AB", "Kinami Yuki's Art", "Kinema Citrus", "KingsIsle Entertainment", "Kitty Films", "Klonoa", "Kodansha", "Koei Tecmo", "KOG Games", "Kojima Productions", "KONAMI", "Konbu Wakame's Works", "Kouhei Horikoshi's Works", "Kouji Seo", "Kuni no Alice Series", "Kunihiko Ikuhara's Works", "Kunio-Kun Franchise", "Kurahana Chinatsu's Art", "Kuroyuki's Art", "Kurumadapro", "Kyoto Animation", "Laika Studios", "Lantis", "Layton Series", "Lego", "Lerche", "Lethal League Series", "Level-5", "Lezhin Comics", "Life is Strange Series", "Lilith Soft", "Line Webtoon", "LISA", "LittleBigPlanet Series", "Lotte Campaigns", "Love Conquers All Games", "Love Live!", "Luck & Logic Series", "Ludosity", "Luigi's Mansion Series", "Luminous Arc Series", "Lump of Sugar", "Lunar Series", "Macross", "Madagascar Series", "Madhouse", "Madoka Magica Series", "MAGES. Inc.", "Mahjong Games", "Mahou Shoujo", "Mahou Shoujo Site Series", "Major Series", "Makoto Shinkai", "Mamoru Hosoda", "Man of Action", "Mana", "Manga Action", "Manga Time Kirara", "MangaGamer", "Manglobe Inc.", "MapleStory Series", "MAPPA", "Mario & Luigi Series", "Marvel Multiverse", "Marvelous", "Masaaki Yuasa", "Mascots Series", "Mass Effect Series", "Masters of the Universe Franchise", "Matt Groening's Works", "Mazinger Series", "Mecha", "Media Factory", "Mega Man", "Megami Tensei", "Memes", "Merryweatherey's Works", "Metal Gear Series", "Metro Series", "Micro Magazine", "Middle-earth", "Middle-earth: Shadow of", "miHoYo", "Miko's Art", "Milkshake!", "Million Arthur", "Minecraft Series", "Mitsuteru Yokoyama's Works", "Miwashiba", "Mizuryu Kei's Works", "MMORPG", "MOBA Games", "Mobile Games", "Monkey Island Series", "Monolith Soft", "Monster Girls", "Monster Hunter Series", "Monster Musume no Iru Nichijou Series", "Mortal Kombat", "Mother", "MTV", "Mugen Souls Series", "Muv-Luv Series", "MXTX", "My Little Pony Series", "Mystery Dungeon Series", "Nagaoka's Art", "Naoki Urasawa", "Naruto Series", "Natsume", "Natsume Akatsuki", "NBCUniversal", "Need for Speed", "Negima! Series", "NekoNyan", "NEOWIZ", "Netflix Originals", "Newgrounds Games", "NEXON", "Nickelodeon", "Nights of Azure Series", "Nihon Falcom", "Nikki UP2U Series", "Nintendo", "Nippon Ichi Software", "Niru Kajitsu", "Nisio Isin", "Nitro+CHiRAL", "Nitroplus", "No More Heroes Series", "Nobuyuki Fukumoto's Works", "Noggin", "Nomnomnami", "NormalBoots", "Nutaku", "Oddworld", "Ōkami Series", "Okegom", "OLM", "ONE's Works", "Orange_Juice", "Osamu Tezuka's Works", "Otome Games", "Otome-Based Stories", "Overlap", "P.A.Works", "Paper Games", "Paper Mario Series", "Pendleton Ward's Works", "Persona", "Persona 2 Duology", "Persona 4 Series", "Persona 5 Series", "Persona Q Series", "Phantasy Star Online", "Phantasy Star Series", "Picture Books", "Pikmin Series", "Pixar Animation Studios", "Pixiv Comic", "Platformer Games", "PlatinumGames", "Podcasts", "Point-and-click Adventure Games", "Pokémon", "Pokémon Anime", "Pokémon Core Games", "Pokémon Games", "Pokémon Movies", "Pokémon Mystery Dungeon", "Pokémon Ranger Series", "Porter Robinson's Works", "Power Rangers", "Powerpuff Girls Bundle", "PreCure Series", "Pretty Rhythm", "Production I.G", "Production IMS", "Project No.9", "ProjectMoon", "Psychonauts Series", "Saya11/28/2019", "Pulltop", "QP Series", "Quake Series", "Queen's Blade Series", "Rainbow Rowell", "Rankin/Bass Productions", "Rareware", "Ratchet & Clank Series", "Ray-kbys", "Rayark Inc.", "Real Life People", "Record of Agarest War Series", "Red Dead Series", "Rejet Drama CD", "Resident Evil Series", "Rhythm Games", "Ribon", "Rick Riordan's Works", "Riot Games", "Robotech", "Rockstar Games", "Rooster Teeth", "Rosenkreuzstilette Series", "RPG Maker Games", "Rumiko Takahashi's Works", "Rune Factory Series", "Sad Panda Studios", "Saint Seiya Series", "Saki Series", "Sakura Series", "Sakura Taisen Series", "Sanrio", "Sanzigen", "Satelight", "Satoi's Art", "Satoshi Kon", "Satoshi Mizukami", "Satoshi Urushihara's Works", "Science Adventure", "Scooby-Doo", "Scott Fellows's Works", "SCP", "SEGA", "Segawa", "Seihou Project", "Seikaisha", "Sekai Project", "Sen's Works", "Sengoku Period Fiction", "Senki Zesshou Symphogear Series", "Sensitive Content", "Seth MacFarlane's Works", "Shadow Hearts Series", "Shadowhunters", "Shaft", "Shall We Date?", "Shin Megami Tensei", "ShindoL's Works", "Shingeki no Bahamut Series", "Shingeki no Kyojin Series", "Shinichiro Watanabe's Works", "Shinza Bansho Series", "Shipgirls", "Shiren the Wanderer Series", "Shogakukan", "Shoot 'em ups", "Shotacon and Lolicon", "Shoujo☆Kageki Revue Starlight Series", "Shounen Gahousha", "Shounen Gangan", "Shouzou Kaga's Works", "Shueisha", "Shuka", "Silent Hill Series", "Silver Link", "Saya01/16/2020", "Sims Series", "Simulation Games", "Sly Cooper", "SNK Corporation", "Sol Press", "Sonic the Hedgehog Series", "Sony Interactive Entertainment", "Souichirou Yamamoto's Works", "Soul Eater Series", "Soul Land Series", "Soulcalibur Series", "Souls Series", "Soviet Games", "Space Ghost Chronology", "Spike Chunsoft", "Spirit Hunter Series", "Splatoon Series", "Sports Animanga", "Sports Games", "Spyro Series", "Square Enix", "Star Ocean Series", "Star Trek Series", "Star Wars Series", "Star Wars: Knights of the Old Republic Series", "Star Wars: The Force Unleashed Series", "Street Fighter", "Streets of Rage Trilogy", "Studio 3Hz", "Studio Chizu", "Studio Comet", "Studio Deen", "Studio Ghibli", "Studio Gokumi", "Studio Pierrot", "STUDIO WASABI", "Sucker Punch Productions", "SUGURI Series", "Suikoden Series", "Summon Night Series", "Sunrise", "Super Dimension Series", "Super Mario", "Super Mario Galaxy Series", "Super Mario World Series", "Super Robot Taisen", "Super Smash Bros. Series", "Supergiant Games", "Sword Art Online Series", "Taimanin", "Taito", "Take-Two Interactive", "Takehito Harada's Works", "Takuma Yokota", "Tales of Arcadia", "Tales of Series", "Tales of Symphonia Series", "Tales of the World: Radiant Mythology Series", "Tappytoon", "Tarzan Series", "Tate no Yuusha Series", "Tatsunoko Production", "Team Ico", "Tecmo's Deception", "Teita's Art", "Tekken", "Teletoon", "Tellius Series", "Telltale Games", "Tencent Penguin Pictures", "Saya06/04/2020", "Tenchi Muyou!", "Tezuka Productions", "The Adventure Zone", "The Behemoth", "The Elder Scrolls", "The Grishaverse", "The iDOLM@STER Series", "The Incredibles Series", "The Jim Henson Company", "The Legend of Heroes", "The Legend of Zelda", "The Little Mermaid Series", "The McElroy Family's Works", "The Muppets", "The Percy Jackson Series", "The Strange Men Series", "The Third Wheel", "The Walking Dead Series", "The Walt Disney Company", "Tim Burton's Works", "TMNT Series", "TMS Entertainment", "To Heart Series", "Toby Fox Games", "Toei Animation", "Toji no Miko Series", "Tokimeki Memorial Series", "Tom Clancy's", "Tony Hawk's Series", "Toonami", "Total Drama", "Touhou Fanworks", "Touhou Project", "Touhou Project (PC-98 Canon)", "Toys", "Trading Card Games", "Transformers Series", "Tri-State Area Series", "Trigger", "Tsugumi Ohba's Works", "Tsukino Talent Productions", "Turn-Based RPGs", "TYPE-MOON", "Tōhō Co., Ltd.", "Ubisoft", "ufotable", "Umaru-chan Universe", "Undertale Fanworks", "Universal Pictures", "Usuba Kagerou's Art", "Utawarerumono Series", "V Jump", "Valentia Series", "Valkyrie Drive Series", "Valve Corporation", "Vanillaware", "ViacomCBS", "Virtual Music", "Virtual Musicians", "Virtual YouTubers", "Visual Novels", "Vivziepop's Works", "Vocaloid Song Series", "Voice Synthesizers", "Voltage Inc.", "Walt Disney Animation Studios", "Wand of Fortune Series", "Warcraft Universe", "Warhammer", "Wario Land Series", "Warner Bros.", "Warriors Series", "WATCH_DOGS Series", "Wayforward", "Weaver", "Web Novels", "Webcomics", "Weekly Shounen Champion", "Weekly Shounen Jump", "Weekly Shounen Magazine", "Weekly Shounen Sunday", "Weekly Young Jump", "Western", "Whedonverse", "When They Cry", "Whispwill", "White Album Series", "White Fox", "Wit Studio", "Witchblade Series", "WIXOSS", "Wizarding World", "WOLF RPG Editor Games", "WOOMA", "Working Designs", "World Witches", "Wreck-It Ralph Series", "Wrestling", "XBox Game Studios", "Xebec", "Xeno Series", "Yakuza Series", "Yoshihiro Togashi's Works", "Yostar Games", "Young Gangan", "YouTube", "Yu-Gi-Oh!", "Yume Nikki Fangames", "Yuusha de Aru Series", "Yuzuki Karu's Art", "Yuzusoft", "Yōkai", "Zero Escape", ":bread:"]:
            self.add_bundle(item)

    def start(self):
        # self.add_bundle('Kyoto Animation')
        self.get_next_command()

    def get_current_filename(self):
        return self.current_filename

    def __set_current_filename(self, command):
        series = Parser.get_series_from_command(command)
        raw_command = Parser.get_raw_command(command)[1:].strip()

        filename = series + '/' + raw_command + '.txt'
        self.current_filename = filename

    def get_last_command(self):
        return self.last_command

    def set_last_command(self, command):
        self.last_command = command
        self.__set_current_filename(command)

    def add_bundle(self, bundle_name):
        if bundle_name in self.bundles_checked:
            return

        self.bundles_checked.add(bundle_name)
        # self.command_queue.put('$imab ' + bundle_name)

        self.command_queue.put('$imaawg ' + bundle_name)
        self.command_queue.put('$imaawg- ' + bundle_name)
        self.command_queue.put('$imaahg ' + bundle_name)
        self.command_queue.put('$imaahg- ' + bundle_name)

    def add_series(self, series_name):
        if series_name in self.series_checked:
            return

        self.series_checked.add(series_name)
        # self.command_queue.put('$imab ' + series_name)

    def get_next_command(self):
        command = self.command_queue.get()
        Ahk.ahk_type(command)
